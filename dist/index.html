<!doctype html><html lang=pt-BR><head><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1" name=viewport><title>Mapa do Bairro</title><link crossorigin=anonymous href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u rel=stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><style>body,html{height:100%;color:#333}body{padding-top:50px;font-family:Roboto,"Helvetica Neue",Helvetica,Arial,sans-serif}.navbar{margin-bottom:0}.marker-img-container{height:calc(100vh - 50px)}.marker-img{position:absolute;width:350px;max-width:75%;left:50%;top:50%;transform:translateX(-50%) translateY(-50%)}.col-aside,.map{padding:0}.map{height:calc(100vh - 50px)}.search-btn,.search-in{height:41px;border-radius:0}.overflow{overflow-y:auto}.marker-list{margin-bottom:0}.list-group-item:first-child{border-radius:0;border-top:0}.list-group-item:last-child{border-radius:0}.info{border-radius:0;border-top:0;margin-bottom:0}@media screen and (min-width:768px){.col-aside,.info{height:calc(100vh - 50px)}.marker-list{height:calc(100vh - 91px)}.navbar-collapse{width:25%}}.info-heading{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.info-close{font-size:.8em}.list-apis{font-size:.9em}.api-title{font-size:1.2em;font-weight:700;margin-top:.5em}.api-title-span{font-size:.7em;font-weight:lighter;color:#4b4b4b}.address{background-color:#f5f5f5}.list-places{padding-left:0;list-style:none}.list-places-item{cursor:pointer}.list-places-item:hover{color:#43434b;background-color:#dfdff6;font-weight:700}.photo{position:relative;margin:0;padding:0}.photo-img{width:100%;border:0}.flickr{position:absolute;top:calc(100% - 32px);left:calc(100% - 65px)}</style></head><body><nav class="navbar navbar-fixed-top navbar-inverse"><div class=container-fluid><button class="btn-hamburguer collapsed navbar-toggle" type=button aria-expanded=false data-target=.navbar-collapse data-toggle=collapse><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=#>Mapa do Bairro</a></div></nav><div class="container-fluid collapse error-img"><div class=row><div class=col-xs-12><div class=marker-img-container><img alt="Imagem marcador google maps" class=marker-img src=img/map-marker-small.svg></div></div></div></div><div class="container-fluid app-view"><div class=row><aside class="collapse col-aside col-sm-3 navbar-collapse" id=collapse><div class="input-group search" data-bind="with: search, visible: search.visible"><span class=input-group-btn><button class="btn btn-success search-btn" type=button><span class="glyphicon glyphicon-search" aria-hidden=true></span></button> </span><input class="form-control search-in" data-bind="textInput: text, event: {keyup: $root.markerList.filter}" placeholder="Filtrar resultados"></div><div class="list-group marker-list overflow" data-bind="foreach: markerList.items,visible: markerList.visible"><button class=list-group-item type=button data-bind="text: title,click: $root.markerList.click,event: {mouseover: $root.mouseOverIcon, mouseout: $root.mouseOutIcon},visible: filtered" name=button></button></div><div class="overflow info panel panel-default" data-bind="with: infoPanel, visible: infoPanel.visible"><div class="info-heading panel-heading"><span data-bind="text: title"></span> <button class="close info-close" type=button data-bind="click: close"><span class="glyphicon glyphicon-remove" aria-hidden=true></span></button></div><ul class="list-group list-apis"><li class="list-group-item photo" data-bind="visible: photo"><img alt="" class="img-responsive photo-img" data-bind="attr: {src: photo}"> <img alt="Flickr logo" class=flickr data-bind="visible: flickr" src=https://s.yimg.com/pw/images/goodies/white-flickr.png></li><li class="list-group-item address" data-bind="text: address, visible: address"></li><li class="list-group-item wiki" data-bind="visible: wiki"><h3 class=api-title>Wikipédia</h3><p data-bind="text: wiki"></p></li><li class="list-group-item places" data-bind="visible: places.items().length > 0"><h3 class=api-title>Google Places <span class=api-title-span>Clique para ver</span></h3><ul class=list-places data-bind="foreach: places.items"><li class=list-places-item data-bind="text: marker.title, click: $parent.places.click"></li></ul></li></ul></div></aside><main class="col-sm-9 map" id=map></main></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js crossorigin=anonymous integrity="sha256-owX7sroiO/O1a7h3a4X29A1g3QgqdNvijRQ7V5TH45M="></script><script src=https://code.jquery.com/jquery-3.2.1.min.js crossorigin=anonymous integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js crossorigin=anonymous integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa></script><script>function app(){"use strict";var s=new google.maps.Map(document.getElementById("map")),n=new google.maps.LatLngBounds,t=new google.maps.InfoWindow,a=new google.maps.places.PlacesService(s),r=new google.maps.Geocoder,e=[{title:"Casa Rosada",position:{lat:-34.608054,lng:-58.370286}},{title:"Plaza de Mayo",position:{lat:-34.608396,lng:-58.372164}},{title:"Museo Casa Rosada",position:{lat:-34.608706,lng:-58.369563}},{title:"Luna Park (Buenos Aires)",position:{lat:-34.602305,lng:-58.368752}},{title:"Puerto Madero",position:{lat:-34.605135,lng:-58.365641}},{title:"Plaza del Congreso",position:{lat:-34.609708,lng:-58.390334}},{title:"Obelisco de Buenos Aires",position:{lat:-34.603736,lng:-58.381573}},{title:"Teatro Colón",position:{lat:-34.601139,lng:-58.38315}},{title:"Galerías Pacífico",position:{lat:-34.599196,lng:-58.374867}},{title:"Centro Cultural Néstor Kirchner",position:{lat:-34.603495,lng:-58.369553}}],g={RED:"http://maps.google.com/mapfiles/ms/icons/red-dot.png",BLUE:"http://maps.google.com/mapfiles/ms/icons/blue-dot.png",GREEN:"http://maps.google.com/mapfiles/ms/icons/green-dot.png"};function o(e){t.setContent(d(e.title)),t.open(s,e)}function d(e){return e.toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})}function k(e){if(e&&"undefined"!==e)return e[0].getUrl({maxWidth:423})}function l(e){var t=new google.maps.LatLngBounds;t.extend(e.getPosition()),e.places.forEach(function(e){t.extend(e.marker.getPosition())}),s.fitBounds(t)}function b(e){var t=new google.maps.Marker(e),o=Object.create(t),i=Object.getPrototypeOf(o);return i.filtered=ko.observable(!0),i.photo="",i.address="",i.wiki="",i.places=[],i.type="",i.getWiki=function(){var e,i,t=this;(e=this.title,i="https://es.wikipedia.org/w/api.php?"+"format=%format%&action=%action%&search=%search%&limit=%limit%&callback=?".replace(/%format%/,"json").replace(/%action%/,"opensearch").replace(/%search%/,e).replace(/%limit%/,1),new Promise(function(t,o){$.ajax({url:i,dataType:"jsonp"}).done(function(e){e?t(e[2][0]):o(Error("Wikipedia error"))}).fail(function(){o(Error("a API da Wikipédia não está disponível nesse momento!"))})})).then(function(e){t.wiki=e},function(e){alert(e)})},i.getAddress=function(){var t=this;(function s(n){return new Promise(function(o,i){r.geocode({location:n},function(e,t){t===google.maps.GeocoderStatus.OK?e[1]&&o(e[0].formatted_address):t===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?setTimeout(function(){s(n).then(function(e){o(e)},function(e){i(e)})},2e3):i(Error("Geocoder status: "+t))})})})(this.position).then(function(e){t.address=e},function(e){alert(e)})},i.getPhoto=function(e){var t,o,i=this;"flickr"===e&&(t=this.title,o="https://api.flickr.com/services/rest/?"+"method=%method%&api_key=%api_key%&text=%text%&license=%license%&content_type=%content_type%&per_page=%per_page%&format=%format%&sort=%sort%&extras=%extras%&nojsoncallback=1".replace(/%method%/,"flickr.photos.search").replace(/%api_key%/,"e7578e7c5110616e04eb5e44bcc7a892").replace(/%text%/,t+" Buenos Aires").replace(/%license%/,"1,2,3,4,5,6,7").replace(/%content_type%/,1).replace(/%per_page%/,10).replace(/%format%/,"json").replace(/%sort%/,"").replace(/%extras%/,"url_m"),new Promise(function(i,e){$.ajax({url:o,dataType:"json"}).done(function(e){if(e)for(var t=0;t<e.photos.photo.length;t++){var o=e.photos.photo[t];if(Number(o.height_m)<Number(o.width_m)){i(o.url_m);break}}}).fail(function(){e(Error("a API do Flickr não está disponível nesse momento!"))})})).then(function(e){i.photo=e},function(e){alert(e)})},i.getPlaces=function(){var h,e,t=this;"listItem"===t.type&&0===t.places.length?(h=t,e={location:h.position,radius:"500"},new Promise(function(u,m){a.nearbySearch(e,function(e,t){if(t===google.maps.places.PlacesServiceStatus.OK){for(var o=[],i=(f=["bar","restaurant","food","lodging"],e.filter(function(t){return f.some(function(e){return-1!==t.types.indexOf(e)})})),s=0;s<i.length;s++){var n=i[s],a=d(n.name),r=n.geometry.location,l=k(n.photos),c=n.rating;if(l&&r&&r!==h.getPosition()){var p=b({title:a,position:n.geometry.location,animation:google.maps.Animation.DROP,icon:g.GREEN});if(p.type="placeItem",p.photo=l,p.getAddress(),o.push({marker:p,rating:c}),10<=o.length)break}}o.sort(function(e,t){return e.marker.title<t.marker.title?-1:e.marker.title>t.marker.title?1:0}),u(o)}else m(Error("a API do Google Places não está disponível nesse momento"));var f})})).then(function(e){t.places=e,f.places.items(t.places),l(t)},function(e){alert(e)}):(f.places.items(t.places),f.places.items().forEach(function(e){e.marker.setVisible(!0)}),l(t))},i.oldSetVisible=i.setVisible,i.setVisible=function(e){this.oldSetVisible(e),this.filtered(e)},o.setMap(s),o.setVisible(!0),o.addListener("click",function(){"placeItem"===this.type?f.places.click(this):"listItem"===this.type&&f.markerList.click(this)}),n.extend(o.position),o}function c(e){e.setZIndex(google.maps.Marker.MAX_ZINDEX),e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},3e3)}function p(){var e=$(".col-aside");e.hasClass("in")&&e.removeClass("in")}var f=new function(){var i=this;i.search={text:ko.observable(""),visible:ko.observable(!0),reset:function(){this.text(""),i.markerList.showAll(!0)}},i.markerList={items:ko.observableArray([]),visible:ko.observable(!0),showAll:function(t){this.items().forEach(function(e){e.setVisible(t)})},filter:function(e,t){if(27===t.keyCode)i.search.reset();else{var o=i.search.text().toLowerCase();i.markerList.items().forEach(function(e){-1!==e.title.toLowerCase().indexOf(o)?e.setVisible(!0):e.setVisible(!1)})}},click:function(e){o(e),c(e),p(),i.search.reset(),i.places.reset(),e.getPlaces(),i.infoPanel.update(e),i.infoPanel.open()}},i.places={items:ko.observableArray([]),click:function(e){var t=null;o(t=e.hasOwnProperty("marker")?e.marker:e),c(t),p(),i.infoPanel.update(t)},reset:function(){this.items().forEach(function(e){e.marker.setVisible(!1)}),this.items([])}},i.infoPanel={title:ko.observable(""),photo:ko.observable(""),flickr:ko.observable(!1),wiki:ko.observable(""),address:ko.observable(""),places:i.places,visible:ko.observable(!1),reset:function(){this.title(""),this.photo(""),this.flickr(!1),this.wiki(""),this.address("")},update:function(e){this.reset(),this.title(e.title),this.flickr(e.photo.match("flickr")),this.photo(e.photo),this.address(e.address),this.wiki(e.wiki)},toggle:function(){this.visible(i.markerList.visible()),i.markerList.visible(!this.visible())},close:function(){i.search.reset(),i.search.visible(!0),t.close(),this.reset(),this.places.reset(),this.toggle(),s.fitBounds(n)},open:function(){i.search.visible(!1),i.markerList.visible(!1),this.visible(!0)}},i.mouseOverIcon=function(e){e.setIcon(g.BLUE)},i.mouseOutIcon=function(e){e.setIcon(g.RED)}};ko.applyBindings(f),e.forEach(function(e){var t=b(e);t.type="listItem",t.getWiki(),t.getAddress(),t.getPhoto("flickr"),t.setIcon(g.RED),f.markerList.items.push(t)}),s.setZoom(18),s.fitBounds(n)}function googleApiError(){"use strict";$(".app-view").hide(),$(".error-img").show(),setTimeout(function(){alert("Google Maps não está disponível nesse momento.")},100)}</script><script src="https://maps.googleapis.com/maps/api/js?v=3&language=pt&region=BR&libraries=places&key=AIzaSyCLNwLl2L9wgxYlVc7HYndbk6T0a_AWWac&callback=app" async defer onerror=googleApiError()></script></body></html>